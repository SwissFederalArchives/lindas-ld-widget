"use strict";(self.webpackChunkld_widget=self.webpackChunkld_widget||[]).push([[928],{928:(I,l,s)=>{s.r(l),s.d(l,{ConfigComponent:()=>k});var r=s(4716),u=s(7048),p=s(5657),h=s(3616),t=s(4496);function c(o,E){if(1&o&&(t.I0R(0,"div")(1,"a",7),t.OEk(2),t.C$Y()()),2&o){const e=t.GaO();t.yG2(),t.E7m("href",e.link,t.K6U),t.yG2(),t.cNF(e.link)}}function f(o,E){if(1&o&&(t.I0R(0,"div")(1,"p"),t.OEk(2),t.C$Y()()),2&o){const e=t.GaO();t.yG2(2),t.cNF(e.link)}}let m=(()=>{class o{constructor(){this.query="",this.endpoint="",this.buttonLabel="",this.ldWidgetUrl=window.location.href.split("?")[0]?.replace("config","")??"",this.link="",this.isLinkValid=!1,this.sampleQuery=C,this.sampleEndpoint=g,this.sampleValues=y,this.formControlNames=[],this.destroy$=new p.E,this.widgetConfigForm=new r.WC({endpoint:new r.Ku(this.endpoint,r.AQ.required),query:new r.Ku(this.query,r.AQ.required),buttonLabel:new r.Ku(this.buttonLabel)})}ngOnInit(){this.widgetConfigForm.valueChanges.pipe((0,h.a)(this.destroy$)).subscribe(e=>{this._createLinkIfValid(e.endpoint??"",e.query??"",e.buttonLabel??"")})}_createLinkIfValid(e,i,n){if(this.isLinkValid=this._checkIfLinkValid(e,i),this.isLinkValid){let a="";n.length>0&&(a=`&b=${encodeURIComponent(n)}`),this.link=`${this.ldWidgetUrl}?e=${encodeURIComponent(e)}&q=${encodeURIComponent(i)}${a}`}else this.link=""}ngOnChanges(e){e.query?.currentValue&&(this.query=e.query?.currentValue.trim(),this.widgetConfigForm.get("query")?.setValue(this.query)),e.endpoint?.currentValue&&(this.endpoint=e.endpoint.currentValue.trim(),this.widgetConfigForm.get("endpoint")?.setValue(this.endpoint)),this._createLinkIfValid(this.endpoint,this.query,this.buttonLabel)}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}_checkIfLinkValid(e,i){return this._checkEndpoint(e)&&this._checkQuery(i)}_checkEndpoint(e){let i;try{i=new URL(e)}catch{return!1}return"http:"===i.protocol||"https:"===i.protocol}_checkQuery(e){return e.includes("?varBind")}static#t=this.\u0275fac=function(i){return new(i||o)};static#e=this.\u0275cmp=t.In1({type:o,selectors:[["app-ld-widget-config"]],inputs:{query:"query",endpoint:"endpoint",buttonLabel:"buttonLabel"},standalone:!0,features:[t.SYr,t.UHJ],decls:49,vars:7,consts:[[3,"formGroup"],["for","endpoint"],["id","endpoint","type","text","formControlName","endpoint",2,"margin-right","4px"],["for","query"],["id","query","rows","30","cols","150","formControlName","query",2,"margin-right","4px"],["id","query","formControlName","buttonLabel",2,"margin-right","4px"],[2,"color","red"],["target","_blank",3,"href"]],template:function(i,n){1&i&&(t.I0R(0,"h1"),t.OEk(1,"Linked Data Widget: Link Configurator"),t.C$Y(),t.I0R(2,"div")(3,"p"),t.OEk(4,"Test link"),t.C$Y(),t.yuY(5,c,3,2,"div")(6,f,3,1,"div"),t.C$Y(),t.wR5(7,"br")(8,"br"),t.I0R(9,"form",0)(10,"div")(11,"label",1),t.OEk(12,"SPARQL Endpoint"),t.C$Y(),t.wR5(13,"input",2),t.C$Y(),t.I0R(14,"div")(15,"label",3),t.OEk(16,"SPARQL Query"),t.C$Y(),t.wR5(17,"textarea",4),t.C$Y(),t.I0R(18,"div")(19,"label",3),t.OEk(20,"Button Label (optional)"),t.C$Y(),t.wR5(21,"input",5),t.C$Y()(),t.I0R(22,"div")(23,"h2"),t.OEk(24,"Sample"),t.C$Y(),t.I0R(25,"h3"),t.OEk(26,"Sample Endpoint"),t.C$Y(),t.I0R(27,"pre"),t.OEk(28),t.C$Y(),t.I0R(29,"h3"),t.OEk(30,"Sample query"),t.C$Y(),t.I0R(31,"pre"),t.OEk(32),t.C$Y()(),t.I0R(33,"div")(34,"h2"),t.OEk(35,"How does that work?"),t.C$Y(),t.I0R(36,"p"),t.OEk(37," The important variable is "),t.I0R(38,"span",6),t.OEk(39,"?varBind"),t.C$Y(),t.OEk(40,". The widget will show an input asking for a value. The variable "),t.I0R(41,"span",6),t.OEk(42,"?varBind"),t.C$Y(),t.OEk(43," will be bound the the value of this input filed. It will just append a VALUES expression to the SPARQL Query. Imagine your input is "),t.I0R(44,"span",6),t.OEk(45,"'990000002998969'"),t.C$Y(),t.OEk(46," this will lead to the following query. "),t.C$Y(),t.I0R(47,"pre"),t.OEk(48),t.C$Y()()),2&i&&(t.yG2(5),t.C0Y(5,n.isLinkValid?5:-1),t.yG2(),t.C0Y(6,n.isLinkValid?-1:6),t.yG2(3),t.E7m("formGroup",n.widgetConfigForm),t.yG2(19),t.cNF(n.sampleEndpoint),t.yG2(4),t.cNF(n.sampleQuery),t.yG2(16),t.CAO("",n.sampleQuery,"",n.sampleValues,""))},dependencies:[r.y,r.sz,r.ot,r.ue,r.u,r.sl,r.uW,r.Wo,u.SU]})}return o})();const g="https://lindas.admin.ch/query",C='\nPREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>\nPREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>\nSELECT ?resultString FROM <https://lindas.admin.ch/fsvo/rabies> WHERE {\n  ?s <https://agriculture.ld.admin.ch/foen/rabies/dimension/identifier> ?varBind;\n  \t <https://agriculture.ld.admin.ch/foen/rabies/dimension/quantitativeresult> ?value ;\n     <https://agriculture.ld.admin.ch/foen/rabies/dimension/result> ?result ;\n     <https://agriculture.ld.admin.ch/foen/rabies/dimension/date> ?date;\n  \t <https://agriculture.ld.admin.ch/foen/rabies/dimension/unitcode> ?unit .\n     BIND ( IF ( ?result = <https://agriculture.ld.admin.ch/foen/rabies/dimension/result/positiv>, "Sufficient", "Insufficient" ) AS ?v )\n  \t BIND(CONCAT("Microchip number: ",?varBind, " | ", ?v, " | ",  "Quantitative Result: ", str(?value), " ", ?unit, " | Date of blood sampling: ", str(?date))  AS ?resultString ) \n} ORDER BY ?date LIMIT 1\n',y="VALUES ?varBind { '990000002998969' }";var d=s(1112);let k=(()=>{class o{constructor(e,i){this.router=e,this.route=i,this.endpoint="",this.sparqlQuery=""}ngOnInit(){this.route.queryParamMap.subscribe(e=>{this.endpoint=e.get("e")??"",this.sparqlQuery=e.get("q")??""})}static#t=this.\u0275fac=function(i){return new(i||o)(t.GI1(d.E5),t.GI1(d.gV))};static#e=this.\u0275cmp=t.In1({type:o,selectors:[["ng-component"]],standalone:!0,features:[t.UHJ],decls:1,vars:2,consts:[[3,"endpoint","query"]],template:function(i,n){1&i&&t.wR5(0,"app-ld-widget-config",0),2&i&&t.E7m("endpoint",n.endpoint)("query",n.sparqlQuery)},dependencies:[m,d.qQ]})}return o})()}}]);