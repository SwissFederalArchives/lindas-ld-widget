"use strict";(self.webpackChunkld_widget=self.webpackChunkld_widget||[]).push([[243],{243:(T,u,r)=>{r.r(u),r.d(u,{ConfigComponent:()=>L});var l=r(895),o=r(433),p=r(529),h=r(579),g=r(482),c=r(403),f=r(421),m=r(32),t=r(256);function v(i,s){if(1&i&&(t.TgZ(0,"div")(1,"a",7),t._uU(2),t.qZA()()),2&i){const e=t.oxw();t.xp6(1),t.Q6J("href",e.link,t.LSH),t.xp6(1),t.Oqu(e.link)}}function q(i,s){if(1&i&&(t.TgZ(0,"div")(1,"p"),t._uU(2),t.qZA()()),2&i){const e=t.oxw();t.xp6(2),t.Oqu(e.link)}}let Z=(()=>{class i{constructor(){this.query="",this.endpoint="",this.ldWidgetUrl=window.location.href.split("?")[0]?.replace("config","")??"",this.link="",this.isLinkValid=!1,this.sampleQuery=U,this.sampleEndpoint=C,this.sampleValues=A,this.formControlNames=[],this.destroy$=new h.x,this.widgetConfigForm=new o.cw({endpoint:new o.NI(this.endpoint,o.kI.required),query:new o.NI(this.query,o.kI.required)})}ngOnInit(){this.widgetConfigForm.valueChanges.pipe(function y(i){return(0,g.e)((s,e)=>{(0,f.Xf)(i).subscribe((0,c.x)(e,()=>e.complete(),m.Z)),!e.closed&&s.subscribe(e)})}(this.destroy$)).subscribe(e=>{this._createLinkIfValid(e.endpoint??"",e.query??"")})}_createLinkIfValid(e,n){this.isLinkValid=this._checkIfLinkValid(e,n),this.link=this.isLinkValid?`${this.ldWidgetUrl}?e=${encodeURIComponent(e)}&q=${encodeURIComponent(n)}`:""}ngOnChanges(e){e.query?.currentValue&&(this.query=e.query?.currentValue.trim(),this.widgetConfigForm.get("query")?.setValue(this.query)),e.endpoint?.currentValue&&(this.endpoint=e.endpoint.currentValue.trim(),this.widgetConfigForm.get("endpoint")?.setValue(this.endpoint)),this._createLinkIfValid(this.endpoint,this.query)}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}_checkIfLinkValid(e,n){return this._checkEndpoint(e)&&this._checkQuery(n)}_checkEndpoint(e){let n;try{n=new URL(e)}catch{return!1}return"http:"===n.protocol||"https:"===n.protocol}_checkQuery(e){return e.includes("?varBind")}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-ld-widget-config"]],inputs:{query:"query",endpoint:"endpoint"},standalone:!0,features:[t.TTD,t.jDz],decls:45,vars:7,consts:[[4,"ngIf"],[3,"formGroup"],["for","endpoint"],["id","endpoint","type","text","formControlName","endpoint",2,"margin-right","4px"],["for","query"],["id","query","rows","30","cols","150","formControlName","query",2,"margin-right","4px"],[2,"color","red"],["target","_blank",3,"href"]],template:function(e,n){1&e&&(t.TgZ(0,"h1"),t._uU(1,"Linked Data Widget: Link Configurator"),t.qZA(),t.TgZ(2,"div")(3,"p"),t._uU(4,"Test link"),t.qZA(),t.YNc(5,v,3,2,"div",0),t.YNc(6,q,3,1,"div",0),t.qZA(),t._UZ(7,"br")(8,"br"),t.TgZ(9,"form",1)(10,"div")(11,"label",2),t._uU(12,"SPARQL Endpoint"),t.qZA(),t._UZ(13,"input",3),t.qZA(),t.TgZ(14,"div")(15,"label",4),t._uU(16,"SPARQL Query"),t.qZA(),t._UZ(17,"textarea",5),t.qZA()(),t.TgZ(18,"div")(19,"h2"),t._uU(20,"Sample"),t.qZA(),t.TgZ(21,"h3"),t._uU(22,"Sample Endpoint"),t.qZA(),t.TgZ(23,"pre"),t._uU(24),t.qZA(),t.TgZ(25,"h3"),t._uU(26,"Sample query"),t.qZA(),t.TgZ(27,"pre"),t._uU(28),t.qZA()(),t.TgZ(29,"div")(30,"h2"),t._uU(31,"How does that work?"),t.qZA(),t.TgZ(32,"p"),t._uU(33," The important variable is "),t.TgZ(34,"span",6),t._uU(35,"?varBind"),t.qZA(),t._uU(36,". The widget will show an input asking for a value. The variable "),t.TgZ(37,"span",6),t._uU(38,"?varBind"),t.qZA(),t._uU(39," will be bound the the value of this input filed. It will just append a VALUES expression to the SPARQL Query. Imagine your input is "),t.TgZ(40,"span",6),t._uU(41,"'990000002998969'"),t.qZA(),t._uU(42," this will lead to the following query. "),t.qZA(),t.TgZ(43,"pre"),t._uU(44),t.qZA()()),2&e&&(t.xp6(5),t.Q6J("ngIf",n.isLinkValid),t.xp6(1),t.Q6J("ngIf",!n.isLinkValid),t.xp6(3),t.Q6J("formGroup",n.widgetConfigForm),t.xp6(15),t.Oqu(n.sampleEndpoint),t.xp6(4),t.Oqu(n.sampleQuery),t.xp6(16),t.AsE("",n.sampleQuery,"",n.sampleValues,""))},dependencies:[o.u5,o._Y,o.Fj,o.JJ,o.JL,o.UX,o.sg,o.u,p.JF,l.O5]}),i})();const C="https://ld.zazuko.com/query/",U='\nPREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>\nPREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>\nSELECT ?resultString FROM <https://lindas.admin.ch/fsvo/rabies> WHERE {\n  ?s <https://agriculture.ld.admin.ch/foen/rabies/identifier> ?varBind;\n     <https://agriculture.ld.admin.ch/foen/rabies/quantitativeresult> ?value ;\n     <https://agriculture.ld.admin.ch/foen/rabies/result> ?result ;\n     <https://agriculture.ld.admin.ch/foen/rabies/date> ?date;\n     <https://agriculture.ld.admin.ch/foen/rabies/unitcode> ?unit .\n     BIND ( IF ( ?result = <https://agriculture.ld.admin.ch/foen/rabies/dimension/result/positiv>, "Positive", "Negative" ) AS ?v )\n     BIND(CONCAT(?v, " | ",  "Quantitative Result: ", str(?value), " ", ?unit, " | ", str(?date))  AS ?resultString ) \n} ORDER BY ?date LIMIT 1\n',A="VALUES ?varBind { '990000002998969' }";var d=r(773);let L=(()=>{class i{constructor(e,n){this.router=e,this.route=n,this.endpoint="",this.sparqlQuery=""}ngOnInit(){this.route.queryParamMap.subscribe(e=>{this.endpoint=e.get("e")??"",this.sparqlQuery=e.get("q")??""})}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(d.F0),t.Y36(d.gz))},i.\u0275cmp=t.Xpm({type:i,selectors:[["ng-component"]],standalone:!0,features:[t.jDz],decls:1,vars:2,consts:[[3,"endpoint","query"]],template:function(e,n){1&e&&t._UZ(0,"app-ld-widget-config",0),2&e&&t.Q6J("endpoint",n.endpoint)("query",n.sparqlQuery)},dependencies:[Z,d.Bz]}),i})()}}]);